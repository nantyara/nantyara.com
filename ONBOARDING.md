# コードベース概要とオンボーディングガイド

このリポジトリは、なんちゃらアイドルのライブ／イベント予定を掲載する静的サイトを生成するための、シンプルな Ruby ベースのコードです。新規参加者向けに、ディレクトリ構造や重要ポイント、次に学習すると良い事項をまとめました。

## ディレクトリ構成

- `data/`
  - `schedules.yml` : イベント情報を YAML 形式で管理しています。`date` は Ruby の `Time` オブジェクトにパースできる ISO8601 形式で記載し、`title`・`site`・`content` を文字列で記述します。
- `scripts/`
  - `generate_current_schedules_page.rb` : 直近のイベント（12 時間以降の未来）を抽出し、`dist/index.html` を生成します。
  - `generate_past_schedules_page.rb` : 過去イベント（12 時間より前）を抽出し、`dist/past.html` を生成します。
  - `index.html.erb` : 上記スクリプトが読み込む ERB テンプレートです。`current` フラグで「今後の予定／これまでの予定」タブの表示を切り替えます。
- `dist/`
  - `css/`・`img/` : 生成済みの公開用アセットです。`dist/index.html` と `dist/past.html` がこのディレクトリに出力されます。
- `Rakefile`
  - `rake build`（デフォルトタスク）が 2 つの生成スクリプトを読み込み、HTML を再生成します。

## 知っておくと良い重要事項

1. **Ruby 標準ライブラリのみで完結** : Gem の依存関係はなく、`erb`・`yaml`・`pathname` などの標準ライブラリだけで処理しています。Ruby が実行できる環境であれば追加セットアップは不要です。
2. **生成物とソースの分離** : `dist/` は生成結果を格納するディレクトリです。テンプレートやデータは `scripts/`・`data/` 内で編集し、`rake` で再生成します。`dist/` を直接編集すると再生成時に上書きされる点に注意してください。
3. **イベントの区分ロジック** : 「12 時間前」より前か後かで、`current`／`past` に振り分けています。公開タイミングによってはイベントが表示されるページが想定と異なる場合があるので、必要に応じて閾値の調整を検討してください。
4. **テンプレートバインディング** : ERB テンプレートは `schedules`（配列）と `current`（真偽値）を受け取り描画します。テンプレート内で追加情報を扱う際は、スクリプトでバインドする変数を増やす必要があります。
5. **スタイル調整の注意** : 現状の CSS は `dist/css/main.css` に直接書かれています。デザインを大きく変更する場合は、ビルドフローを壊さないように CSS の構造を把握してから作業してください。

## 次に学習すると良いトピック

- **ERB とテンプレートエンジンの基礎** : `<% %>`・`<%= %>` の使い方やバインディングの仕組みを理解すると、テンプレートの拡張がスムーズになります。
- **YAML フォーマットと Time パース** : `schedules.yml` に新しいフィールドを追加する際は、Ruby の `YAML.load_file` でどのように読み込まれるか確認し、`Time.parse` の挙動も合わせて理解しておくと安心です。
- **Rake タスクの追加方法** : ビルドステップを自動化したい場合や、サイトマップ・RSS など別の生成物を追加したい場合は、Rake で新しいタスクを定義する方法を学ぶと応用が利きます。
- **静的サイト運用のベストプラクティス** : デプロイ手順の自動化、GitHub Pages などのホスティングとの連携を調査しておくと、運用面で役立ちます。

## 最初のステップ例

1. `rake` を実行してローカルで HTML が生成されることを確認する。
2. `data/schedules.yml` にテスト用のイベントを追加し、表示結果が期待どおりに変わるか確認する。
3. `scripts/index.html.erb` のテキストを一部変更して、テンプレートがどのように反映されるか学ぶ。
4. `dist/css/main.css` に簡単なスタイル変更を加え、デザイン更新の流れを掴む。

## サポート

セットアップや不明点があれば、既存メンバーに `rake` の実行結果や編集したファイルを共有しながら相談してください。シンプルな構成なので、まずは小さな変更から慣れていくことをおすすめします。
